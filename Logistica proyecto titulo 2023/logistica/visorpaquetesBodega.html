<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Logística - Paquetes</title>
    <link rel="stylesheet" href="visorpaquetes.css">
    <!-- Bootstrap CSS (asegúrate de incluir la ruta correcta) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-b1eYf01dQ+KbTC1m2VTZO2DYiWl0pZl+ZErOVqfmMIMWh73yV89iDd1swCt11SRZ" crossorigin="anonymous">
</head>
<body>
    <header>
        <!-- Contenido del encabezado, si es necesario -->
    </header>

    <nav>
        <div class="logo-container">
          <img src="imagenes/logo.png" alt="Logo" class="logo">
        </div>
        <ul>
            <a href="bodeguero.html"><li>inicio</li></a>
            <a href="visorpaquetesBodega.html"><li>Ver paquetes</li></a>
            <a href="ActualizarPaqueteBodega.php"><li>Actualizar Paquetes</li></a>
        </ul>
      </nav>

    <br><br><br>

    <article class="article-container">
        <div class="container py-4 text-center">
            <h2>Paquetes</h2>

<div class="row g-4">
    <div class="col-auto">
        <div class="form-group">
            <label for="num_registros" class="col-form-label">Mostrar: </label>
            <select name="num_registros" id="num_registros" class="form-select">
                <option value="10">10</option>
                <option value="25">25</option>
                <option value="50">50</option>
                <option value="100">100</option>
            </select>
            <label for="num_registros" class="col-form-label"> </label>
        </div>
    </div>
<Br>
    <div class="col-5"></div>

    <div class="col-auto">
        <div class="form-group">
            <label for="codigo" class="col-form-label">Buscar: </label>
            <input type="text" name="codigo" id="codigo" class="form-control">
        </div>
    </div>
</div>

            <div class="row py-4">
                <div class="col">
                    <table class="table table-sm table-bordered table-striped">
                        <thead>
                            <th class="sort asc">Código</th>
                            <th class="sort asc">Servicio</th>
                            <th class="sort asc">Origen</th>
                            <th class="sort asc">Destino</th>
                            <th class="sort asc">Remitente</th>
                            <th class="sort asc">Dirección de Entrega</th>
                            <th class="sort asc">Destinatario</th>
                            <th class="sort asc">Estado</th>
                            <th class="sort asc">Receptor</th>
                            <th class="sort asc">Fecha de modificacion</th>
                            <th class="sort asc">Ubicacion</th>
                        </thead>
                        <tbody id="content"></tbody>
                    </table>
                </div>
            </div><br>

            <div class="row" >
                <div class="col-6">
                    <label id="lbl-total"></label>
                </div>
                <div class="col-6" id="nav-paginacion"></div>

                <input type="hidden" id="pagina" value="1" >
                <input type="hidden" id="orderCol" value="0">
                <input type="hidden" id="orderType" value="asc">
            </div><br>
        </div>
    </article>

    <br><br><br>

    <footer>
        <div class="container">
          <div class="footercolumna">
            <h4>Contacto</h4>
            <ul>
              <li><img src="imagenes/wtsp.png" class="wtsp"><a>2123</a></li>
              <li><a>a</a></li>
            </ul>
          </div>
          <div class="footercolumna">
            <h4>Redes sociales</h4>
            <ul>
              <li><a><img src="imagenes/insta.png" class="insta">INSTAGRAM</a></li>
              <li><a><img src="imagenes/face.png" alt="face" class="face">FACEBOOK</a></li>
              <li><a><img src="imagenes/twitter.png" alt="twitter" class="twitter">TWITTER</a></li>
            </ul>
          </div>
        </div>
      </footer>

    <!-- Bootstrap core JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

    <script>
        // Llamando a la función getData()
        getData();

        // Escuchar un evento keyup en el campo de entrada y luego llamar a la función getData.
        document.getElementById("codigo").addEventListener("keyup", function() {
            getData();
        }, false);

        document.getElementById("num_registros").addEventListener("change", function() {
            getData();
        }, false);

        // Peticion AJAX
        function getData() {
            let input = document.getElementById("codigo").value;
            let num_registros = document.getElementById("num_registros").value;
            let content = document.getElementById("content");
            let pagina = document.getElementById("pagina").value;
            let orderCol = document.getElementById("orderCol").value;
            let orderType = document.getElementById("orderType").value;

            if (pagina == null) {
                pagina = 1;
            }

            let url = "load.php";
            let formData = new FormData();
            formData.append('codigo', input);
            formData.append('registros', num_registros);
            formData.append('pagina', pagina);
            formData.append('orderCol', orderCol);
            formData.append('orderType', orderType);

            fetch(url, {
                method: "POST",
                body: formData
            }).then(response => response.json())
                .then(data => {
                    content.innerHTML = data.data;
                    document.getElementById("lbl-total").innerHTML = 'Mostrando ' + data.totalFiltro +
                        ' de ' + data.totalRegistros + ' registros';
                    document.getElementById("nav-paginacion").innerHTML = data.paginacion;
                }).catch(err => console.log(err));
        }

        function nextPage(pagina) {
            document.getElementById('pagina').value = pagina;
            getData();
        }

        let columns = document.getElementsByClassName("sort");
        let tamanio = columns.length;
        for (let i = 0; i < tamanio; i++) {
            columns[i].addEventListener("click", ordenar);
        }

        function ordenar(e) {
            let elemento = e.target;

            document.getElementById('orderCol').value = elemento.cellIndex;

            if (elemento.classList.contains("asc")) {
                document.getElementById("orderType").value = "asc";
                elemento.classList.remove("asc");
                elemento.classList.add("desc");
            } else {
                document.getElementById("orderType").value = "desc";
                elemento.classList.remove("desc");
                elemento.classList.add("asc");
            }

            getData();
        }
    </script>
</body>
</html>